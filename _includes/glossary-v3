{% 
for hay in include.data
%}{% 
   assign id = hay.title | replace: "_", " " | slugify
%}{% 
   unless include.id == ""
%}{%
      assign id = id | prepend: '-' | prepend: include.id
%}{% 
   endunless
%}<blockquote
    class="interface{% if include.top %} top-toggle{% endif %}"
    style="order: {{ hay.order }}">
{% if hay.schema_type %}
  <script type="application/ld+json">
  {
    "@context": {
      "rdfa": "https://www.w3.org/ns/rdfa#",
      "schema": "https://schema.org/",
      "cd": "https://cdwn.tk/"
    },
    "@graph": [{
      "@id": "{{ page.url | absolute_url }}#{{ id }}",
      "@type": "{% if hay.schema_type == "cd:Character" %}schema:Person{% elsif hay_schema_type == "schema:Location" %}{% else %}schema:Thing{% endif %}",
      "schema:additionalType:": "{{ hay.schema_type }}",
      "schema:name": "{{ hay.title }}",
      "schema:url": "{{ page.url | absolute_url }}#{{ id }}",
      {% if hay.element %}
        "cd:element": {{ hay.element | jsonify }},
      {% endif %}
      {% if hay.effect %}
        "cd:effect": {{ hay.effect | jsonify }},
      {% endif %}
      {% if hay.resistance %}
        "cd:elementalResistance": {{ hay.resistance | jsonify }},
      {% endif %}
      {% if hay.weakness %}
        "cd:elementalWeakness": {{ hay.weakness | jsonify }},
      {% endif %}
      {% if hay.character %}
      {% assign char = hay.character | append: '-latest' %}
      {% assign character = site.data.characters[char] %}
      "schema:gender": { 
        "@type": "{{ character.gender }}", 
        "@value": "{{ character.gender | split: '/' | last }}"
      },
      "cd:races": {{ character.races | jsonify }},
      "schema:height": {
        "@type": "schema:Distance",
        "@value": "{{ character.appearance.height }}"
      },
      {% endif %}
      "schema:description": "{{ hay.description | markdownify | strip_html | }}"
    }
  }
  </script>
  {% endif %}
    <p class="inactive{% if hay.link %} link{% endif %}" {% if hay.children or hay.description or hay.character %}onclick="toggleAccordion(this)"{% endif %} id="{{ id }}" style="order: -1">
      {% if hay.link %}<a href="{{ "/glossary/" | append: '#' | append: hay.link }}" onclick="openHash('{{ hay.link }}')">{% endif %}{{ hay.title }}{% if hay.link %}</a>{% endif %}
      {% if hay.subtitle %}<small>{{ hay.subtitle }}</small>{% endif %}
    </p>
  {% if hay.description %}
    <div style="order: 1">
      {{ hay.description | markdownify }}
    </div>
  {% endif %}
  {% if hay.character %}
    {% assign char = hay.character | append: '-latest' %}
    <blockquote class="interface" style="order: 10"><p class="inactive" onclick="toggleAccordion(this)">Profile</p>
      {% include character-info character=char %}
    </blockquote>
    {% capture window %}{% include character-window character=char %}{% endcapture %}
    {{ window | markdownify }}
  {% endif %}
  
  {% assign stack = hay.children %}
  {% include glossary-v3 data=stack top=false id=id %}
</blockquote>
{% 
endfor
%}
